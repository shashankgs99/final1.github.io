<div layout="column" layout-align="start center" ng-cloak layout-wrap>
    <div layout="row" layout-sm="column" ng-if="showLoader" layout-align="center center" class="loader">
        <div layout="column">
            <md-progress-circular md-mode="indeterminate" class="loader2"></md-progress-circular>
        </div>
    </div>
    <md-content class="main-card md-margin md-padding">
        <div layout="column" class="md-padding md-title" ng-if="invoice.id" layout-align="start center">
            <div layout="row">
                <div flex>Invoice Number : {[{invoice.invoice_number}]} For
                    <span> So Number : {[{invoice.so.so_number}]}</span>
                </div>
            </div>
        </div>
        <md-tabs md-dynamic-height md-border-bottom md-selected="tabIndex">
            <md-tab label="Invoice" class="md-margin md-padding">
                <md-content class="md-margin md-padding">
                    <div layout="row" class="md-margin md-padding md-title" ng-if="order.id">
                        <div flex></div>
                        <div flex></div>
                        <div flex>
                            <md-button type="submit" name="editInvoice" class="md-primary md-raised cr-md-primary" ng-click="EditInvoice()"
                                ng-if="disabledInvoice">
                                Edit
                            </md-button>
                        </div>
                    </div>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Customer</label>
                                <md-select ng-model="invoice.customer" ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="customer in customersList" ng-value="customer.id">
                                        {[{customer.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>SO Number</label>
                                <md-select ng-model="invoice.soNumber" ng-change="FilterSODetails(invoice.soNumber)"
                                    ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="number in SOList" ng-value="number">
                                        {[{number.so_number}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Installments</label>
                                <md-select ng-model="invoice.installment" ng-disabled="invoice.id"
                                    ng-change="FilterInstallmentDetails(invoice.soNumber)" ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="installment in installments" ng-value="installment">
                                        {[{installment.installment_number}]}. {[{installment.type}]} ,
                                        {[{installment.percentage}]}%
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                    </div>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label class="md-caption">Invoice Type</label>
                                <md-select ng-model="invoice.invoice_type" required ng-change="SelectTitle(invoice.invoice_type)"
                                    ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="title in invoiceTypes" ng-value="title.id">
                                        {[{title.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Invoice Title</label>
                                <md-select ng-model="invoice.invoice_title" ng-disabled="true">
                                    <md-option ng-repeat="title in invoiceTitles" ng-value="title.id">
                                        {[{title.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Supplier Invoice Number</label>
                                <input type="text" ng-model="invoice.supplier_invoice_number">
                            </md-input-container>
                        </div>
                    </div>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Invoice Date</label>
                                <md-datepicker type="date" layout="row" required name="invoiceDate" id="invoiceDate"
                                    ng-model="invoice.invoiceDate"></md-datepicker>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Delivery Terms</label>
                                <input type="text" ng-model="invoice.delivery_terms">
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block" ng-if="invoice.id">
                                <label>Invoice State</label>
                                <md-select ng-model="invoice.invoice_state">
                                    <md-option ng-repeat="title in invoiceStates" ng-value="title.id">
                                        {[{title.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                    </div>
                    <label class="md-subhead" layout-margin>Invoiced by</label>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Supplier Name</label>
                                <input type="text" ng-model="invoice.invoice_from_name">
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Supplier Address</label>
                                <md-select ng-model="invoice.invoice_from_address" required ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="title in supplierAddress" ng-value="title.id">
                                        {[{title.address}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Contact Details</label>
                                <input type="text" ng-model="invoice.invoice_from_contact_details">
                            </md-input-container>
                        </div>
                    </div>
                    <div layout="row" class="ml-padding-t-16" layout-xs="100">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Supplier Tax Details</label>
                                <md-select ng-model="invoice.supplier_tax_details" multiple ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="tax in supplierTaxData" ng-value="tax.id">
                                        {[{tax.taxType.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Bank Details</label>
                                <md-select ng-model="invoice.bank_details" multiple ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="bank in bankDetails" ng-value="bank.id">
                                        {[{bank.bank_name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex></div>
                    </div>
                    <label class="md-subhead" layout-margin>Invoiced to</label>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Buyer Name</label>
                                <input type="text" ng-model="invoice.invoice_to_name">
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Buyer Address</label>
                                <md-select ng-model="invoice.invoice_to_address" required ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="title in buyerAddress" ng-value="title.id">
                                        {[{title.address}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Contact Details</label>
                                <input type="text" ng-model="invoice.invoice_to_contact_details">
                            </md-input-container>
                        </div>
                    </div>
                    <!-- <div layout="row" class="ml-padding-t-16">
                        <div layout-margin flex>
                            <md-input-container class="md-block">
                                <label>Buyer Tax Details</label>
                                <md-select ng-model="invoice.buyer_tax_details" multiple ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="tax in buyerTaxData" ng-value="tax.id">
                                        {[{tax.taxType.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex></div>
                        <div layout-margin flex></div>
                    </div> -->
                    <label class="md-subhead" layout-margin>Shipped To</label>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Name</label>
                                <input type="text" ng-model="invoice.invoice_ship_to_name">
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Address</label>
                                <md-select ng-model="invoice.invoice_ship_to_address" required
                                    ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="title in buyerAddress" ng-value="title.id">
                                        {[{title.address}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Contact Details</label>
                                <input type="text" ng-model="invoice.invoice_ship_to_contact_details">
                            </md-input-container>
                        </div>
                    </div>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <label>Shipping Tax Details</label>
                                <md-select ng-model="invoice.ship_to_tax_details" multiple ng-disabled="disabledInvoice">
                                    <md-option ng-repeat="tax in buyerTaxData" ng-value="tax.id">
                                        {[{tax.taxType.name}]}
                                    </md-option>
                                </md-select>
                            </md-input-container>
                        </div>
                        <div layout-margin flex></div>
                        <div layout-margin flex></div>
                    </div>
                    <div layout="row" class="ml-padding-t-16" layout-xs="column">
                        <div layout-margin flex flex-xs="100">
                            <md-input-container class="md-block">
                                <textarea placeholder="Declaration" ng-model="invoice.declaration" rows="6" md-select-on-focus></textarea>
                            </md-input-container>
                        </div>
                    </div>
                    <div layout="row" layout-align="end end" ng-if="!disabledInvoice">
                        <md-button class="md-primary md-raised cr-md-primary" type="submit" ng-click="SaveInvoice(invoice)">
                            Save
                        </md-button>
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="cancel()">
                            Cancel
                        </md-button>
                    </div>
                </md-content>
            </md-tab>
            <md-tab label="Add Items" ng-disabled="!invoice.id">
                <md-content class="md-padding md-margin">
                    <div layout="row" class="md-display-1">
                        Item Details
                    </div>
                    <div>
                        <div layout="row" class="margin-top-2">
                            <md-checkbox ng-model="selectall" ng-click="selectAllItems(selectall)">Select all
                            </md-checkbox>
                        </div>
                        <div id="invoice-payment-grid" ui-grid="uiGridOptions" class="grid grid-table-width" ui-grid-edit flex flex-xs="100">
                        </div>
                    </div>
                    <div layout="row" class="justify-content margin-top-2">
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="cancel()">
                            Cancel
                        </md-button>
                        <md-button type="submit" name="createOrder" class="md-primary md-raised cr-md-primary" ng-click="SaveItems()">
                            Add To List
                        </md-button>
                    </div>
                    </md-content>
            </md-tab>
            <md-tab label="List" ng-disabled="!invoice.id">
                <md-content class="md-padding md-margin">
                    <div layout="row" class="md-display-1">
                        Item List Seleced For Invoicing
                    </div>
                    <div layout="row" class="md-margin md-padding" layout-align="end end" layout-xs="column">
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="GoToItems()">
                            Add Items
                        </md-button>
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="updateDetails($event)">
                            Update Details
                        </md-button>
                        <md-button type="submit" name="createOrder" class="md-raised md-warn cr-md-primary"
                            ng-click="RemoveItem()">
                            Remove
                        </md-button>
                    </div>
                    <div layout="row">
                        <md-checkbox ng-model="selected" ng-click="selectAll(selected)">Select all</md-checkbox>
                    </div>
                    <div id="invoice-item-list-grid" ui-grid="uiGridOptionsForInvoiceList" flex flex-xs="100" class="grid grid-table-width" ui-grid-edit></div>
                    <div id="invoice-previous-item-list-grid" ui-grid="uiGridOptionsPreviousInvoiceList" ng-if="showRecordsTable"
                        class="grid grid-table-width margin-top-2" ui-grid-edit flex flex-xs="100"></div>
                    <div layout="row" class="float-right">
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="cancel()">
                            Cancel
                        </md-button>
                        <md-button type="submit" name="createOrder" class="md-primary md-raised cr-md-primary"
                            ng-click="UpdateInvoiceItems()">
                            Save
                        </md-button>
                    </div>
                </md-content>
            </md-tab>
        </md-tabs>
    </md-content>
</div>