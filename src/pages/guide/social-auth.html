<!-- Social Auth -->
<section class="container">
  <div class="row column">
    <h5>Social Auth <small>Django</small></h5>
    <p class="larger-font underline">Pre-Requisites</p>
    <ul>
      <li>We will be using <code>Python-Social-Core</code>. Refer <a href="https://github.com/python-social-auth/social-core">here</a></li>
      <li>And it will be made suitable for django using <code>Social-App-Django</code>. Refer <a href="https://github.com/python-social-auth/social-app-django">here</a></li>
    </ul>
    
    <accordion>
      <accordion-group>
        <accordion-heading>
          Supported Social Media(s)
        </accordion-heading>
          <ul>
            <li>Angel OAuth2</li>
            <li>Beats OAuth2</li>
            <li>Behance OAuth2</li>
            <li><span class="bold">Bitbucket OAuth1</span></li>
            <li>Box OAuth2</li>
            <li>Dailymotion OAuth2</li>
            <li>Deezer OAuth2</li>
            <li>Disqus OAuth2</li>
            <li>Douban OAuth1 and OAuth2</li>
            <li><span class="bold">Dropbox OAuth1</span></li>
            <li>Evernote OAuth1</li>
            <li><span class="bold">Facebook OAuth2 and OAuth2 for Applications</span></li>
            <li>Fitbit OAuth2 and OAuth1</li>
            <li>Flickr OAuth1</li>
            <li>Foursquare OAuth2</li>
            <li><span class="bold">Google App Engine Auth</span></li>
            <li>GitHub OAuth2</li>
            <li><span class="bold">Google OAuth1, OAuth2 and OpenId</span></li>
            <li>Instagram OAuth2</li>
            <li>Kakao OAuth2</li>
            <li>Linkedin OAuth1</li>
            <li>Live OAuth2</li>
            <li>Livejournal OpenId</li>
            <li>Mailru OAuth2</li>
            <li>MineID OAuth2</li>
            <li>Mixcloud OAuth2</li>
            <li>Mozilla Persona</li>
            <li>NaszaKlasa OAuth2</li>
            <li>NGPVAN ActionID OpenId</li>
            <li>Odnoklassniki OAuth2 and Application Auth</li>
            <li>OpenId</li>
            <li>Podio OAuth2</li>
            <li>Pinterest OAuth2</li>
            <li>Rdio OAuth1 and OAuth2</li>
            <li>Readability OAuth1</li>
            <li>Shopify OAuth2</li>
            <li>Skyrock OAuth1</li>
            <li>Soundcloud OAuth2</li>
            <li>Spotify OAuth2</li>
            <li>ThisIsMyJam OAuth1</li>
            <li>Stackoverflow OAuth2</li>
            <li>Steam OpenId</li>
            <li>Stocktwits OAuth2</li>
            <li>Stripe OAuth2</li>
            <li>Tripit OAuth1</li>
            <li>Tumblr OAuth1</li>
            <li>Twilio Auth</li>
            <li>Twitch OAuth2</li>
            <li><span class="bold">Twitter OAuth1</span></li>
            <li>Upwork OAuth1</li>
            <li>Vimeo OAuth1</li>
            <li>VK.com OpenAPI, OAuth2 and OAuth2 for Applications</li>
            <li>Weibo OAuth2</li>
            <li>Wunderlist OAuth2</li>
            <li>Xing OAuth1</li>
            <li>Yahoo OpenId and OAuth1</li>
            <li>Yammer OAuth2</li>
          </ul>
      </accordion-group>
      <accordion-group>
        <accordion-heading>
          Important Features
        </accordion-heading>
        <ol>
          <li>Basic user data population to allow custom field values</li>
          <li>Associating multiple social accounts with the same user</li>
          <li>Authentication and disconnection processing based on custom requirements</li>
        </ol>
      </accordion-group>
      <accordion-group>
        <accordion-heading>
          Installation
        </accordion-heading>
        <p><code>Python-Social-Auth</code> is very modular. We will extend this using <code>social-auth-app-djnago</code></p>
        <p>Optional dependecies (if requried)</p>
        <ul>
          <li>OpenIDConnect</li>
          <li>SAML</li>
        </ul>
        <p class="bold">Installation Steps</p>
        <ul>
          <li><code>pip install social-auth-core</code></li>
          <li><code>pip install social-auth-app-django</code></li>
        </ul>
      </accordion-group>
    </accordion>
  </div>
</section>
<!-- Installation -->
<section class="container">
  <div class="row small-up-2 margin-top-2">
    <div class="column">
      <p class="larger-font underline">Configuring Django</p>
      <accordion>
        <accordion-group>
          <accordion-heading>
            Settings
          </accordion-heading>
          <ul>
            <li>Put <code>'social django',</code> in the <code>INSTALLED_APPS</code> present in <code>config>common>apps</code></li>
            <li>
              Setting up the <code>url</code> is a tricky task since it will involve us to do both of the following
              <ol>
                <li>Add this to url_patterns <code>url(r'^api/', include('social_django.urls', namespace='social')),</code></li>
                <li>Not for custom namespace to work we have to also declare <code>SOCIAL_AUTH_URL_NAMESPACE = 'social'</code> at <code>socialAuth.py</code> file</li>
              </ol>
            </li>
          </ul>
        </accordion-group>
        <accordion-group>
          <accordion-heading>
            Personalised Configuration  <code>SOCIAL_AUTH_PIPELINE</code>
          </accordion-heading>
             <p>This is the sequence of actions that will be performed during authentication</p> <br>
             <ul>
               <li><span class="bold">social_details</span> - Get the information we can about the user and return it in a simple format to create the user instance later. On some cases the details are already part of the auth response from the provider, but sometimes this could hit a provider API.</li>
               <li><span class="bold">social_uid</span> - Get the social uid from whichever service we’re authing thru. The uid is the unique identifier of the given user in the provider.</li>
               <li><span class="bold">auth_allowed</span> - Verifies that the current auth process is valid within the current project, this is where emails and domains whitelists are applied (if defined).</li>
               <li><span class="bold">social_user</span> - Checks if the current social-account is already associated in the site.</li>
               <li><span class="bold">get_username</span>- Make up a username for this person, appends a random string at the end if there’s any collision.</li>
               <li><span class="bold">create_user</span> - Create a user account if we haven’t found one yet.</li>
               <li><span class="bold">associate_user</span> - Create the record that associated the social account with this user.</li>
               <li><span class="bold">extra_data</span> - Populate the extra_data field in the social record with the values specified by settings (and the default ones like access_token, etc).</li>
               <li><span class="bold">user_details</span> - Update the user record with any changed info from the auth service.</li>
               <li><span class="bold">associate_by_email</span> - Associate current auth with a user with the same email address in the DB. Obs: This pipeline entry is not 100% secure unless you know that the providers enabled enforce email verification on their side, otherwise a user can attempt to take over another user account by using the same (not validated) email address on some provider.</li>

              </ul>
        </accordion-group>
        <accordion-group>
          <accordion-heading>
            SOCIAL_AUTH_ADMIN_USER_SEARCH_FIELDS 
          </accordion-heading>
            This will provide settings control on which search (lookup) fields to look for while authentication a user. <br>
            <code>SOCIAL_AUTH_ADMIN_USER_SEARCH_FIELDS = ['username', 'first_name', 'email']</code>
        </accordion-group>
        <accordion-group>
          <accordion-heading>
            SOCIAL_AUTH_USER (Difficult part)
          </accordion-heading>
            This requires us to extend normal <code>User</code> to a custom <code>User</code>
            <ul>
              <li>First step is to ensure that User object is called using this function everywhere. This will ensure that when settings are updated it is properly propagated</li>
              <pre>
from django.contrib.auth import get_user_model
User = get_user_model()
              </pre>
              <li>Ensure that new user app doesn't have the name <code>user</code></li>
              <li>Extend the user simply by using this code:
              <pre>
class User(AbstractUser):
  bio = models.TextField(max_length=500, blank=True)
  location = models.CharField(max_length=30, blank=True)
  birth_date = models.DateField(null=True, blank=True)
              </pre>
              </li>
              <li>Add this to settings.py of django as <code>AUTH_USER_MODEL = 'custom_auth.User'</code></li>
              <li>Register the user to access it from Admin View</li>
            </ul>
        </accordion-group

      </accordion>
    </div>
    <div class="column">
      <p class="larger-font underline">How does it work?</p>
      <accordion>
        <accordion-group>
          <accordion-heading>
            Url working with REST
          </accordion-heading>
            <p>Python Social Auth (PSA) opens following urls for the REST APIs</p>
            <ul>
              <li><code>/login/{social_site}</code> & has a name <code>begin</code></li>
              <li><code>/complete/{social_site}</code> & has a name <code>complete</code></li>
              <li><code>/disconnect/{social_site}</code> & has a name <code>disconnect</code></li>
              <li><code>/disconnect/{social_site}/{association_id}</code> & has a name <code>disconnect_individual_social_account</code> This means that disconnecting one of many social accounts</li>
            </ul>
        </accordion-group>
        <accordion-group>
          <accordion-heading>
            How to get social site login url
          </accordion-heading>
            <p>Python Social Auth (PSA) doesn't have a documentation of social site login url. So we will have to find it by experimentation or using this process</p>
            <ul>
              <li>Look for <code>SOCIAL_AUTH_XXX_SCOPE</code> using search functionality of PSA documentation.</li>
              <li>For example search for <code>SOCIAL_AUTH_GOOGLE</code> will lead us to <code>SOCIAL_AUTH_GOOGLE_OAUTH2_SCOPE</code></li>
              <li>Here <code>XXX</code> becomes <code>GOOGLE_OAUTH2</code></li>
              <li><code>Goggle_OAuth2</code>becomes <code>google-oauth2</code></li>
              <li class="bold">Typically it will be simple as <code>twitter</code> for most of the social accounts which support single authentication strategy</li>
            </ul>
        </accordion-group>
      </accordion>
    </div>
  </div>
</section>
<section class="container margin-top-2">
  <div class="row column align-center">
    <p class="larger-font underline">Testout Area</p>
    <a href="/api/login/google-oauth2"><button class="button primary light-color">Login with Google</button></a>
  </div>
</section>