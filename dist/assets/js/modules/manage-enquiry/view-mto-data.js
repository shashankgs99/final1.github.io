"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}!function(){var app=angular.module("app");app.controller("layout.standard.viewMTOData",["$scope","Notification","$mdDialog","$dialogScope","MTOService","MTOGroupService","uiGridExporterService","uiGridExporterConstants",function($scope,Notification,$mdDialog,$dialogScope,MTOService,MTOGroupService,uiGridExporterService,uiGridExporterConstants){$scope.selected=[],$scope.showmtoList=!!$dialogScope.showmtoList&&$dialogScope.showmtoList,$scope.showmtoList&&($scope.disableSave=!0),$scope.query={order:"name",limit:5,page:1},$scope.visible=$dialogScope.visible,$dialogScope.group_number&&($scope.group_number=$dialogScope.group_number),$dialogScope.items&&$dialogScope.items.length&&($dialogScope.items=$dialogScope.items.map(function(item){if(item)return item.item_number&&(item.displayId=item.item_number.split("-").pop().split("_").pop()),item}),$dialogScope.items=_.sortBy($dialogScope.items,"item_number")),$scope.data=$dialogScope.items,$scope.dataLength=$dialogScope.items.length,$scope.tableHeadings=["Item Number","Title","Description","Category","Sub Category","Secondary sub category","Tertiary sub category","Material Of Construction","Material of grade","Material specification","Dimension a","Unit a","Dimension b","Unit b","Dimension c","Unit c","Total quantity","Quantity Ordered","Qunatity Remaining","Unit of measure","Buyer Notes"],$scope.disableSave=$dialogScope.disableSave,$scope.cancel=function(){$scope.selected=[],$mdDialog.hide()},$scope.save=function(data){return $scope.dataLength===$scope.selected.length?$scope.selected.indeterminate=!1:$scope.selected.indeterminate=!0,$mdDialog.hide($scope.selected),$scope.selected},$scope.checkEnquiry=function(record){record.enquiry&&Notification.warning({message:"This item is already part of an enquiry.",positionX:"right",positionY:"top"})},$scope["delete"]=function(){var res=[];if(!$scope.selected.length)return void Notification.error({message:"please select records to delete",positionX:"right",positionY:"top"});var groupId=$scope.selected[0].group;$scope.selected.map(function(item){MTOService["delete"](item.id).then(function(data){res.push(data.data),$scope.selected.length===res.length&&($scope.data.length===$scope.selected.length?MTOGroupService["delete"](groupId).then(function(res){Notification.success({message:"Successfully deleted",positionX:"right",positionY:"top"}),$mdDialog.hide({"delete":!0})}):(Notification.success({message:"Successfully deleted",positionX:"right",positionY:"top"}),$mdDialog.hide({"delete":!0})))})})},$scope.uiGridOptions=_defineProperty({data:$scope.data,enableCellEditOnFocus:!0,enableColumnResizing:!0,enableFiltering:!0,enableGridMenu:!0,showGridFooter:!0,showColumnFooter:!0,fastWatch:!0,exporterCsvFilename:"PR-Items of "+$scope.group_number+".csv",exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),onRegisterApi:function(gridApi){$scope.gridApi=gridApi},columnDefs:[{name:"id",displayName:"#",width:50,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"title",displayName:"Title",width:150,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"description",displayName:"Description",width:200,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"category",displayName:"Category",width:125,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"sub_category",displayName:"Sub Category",width:125,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"sub_sub_category",displayName:"Secondary Sub Category",width:125,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"sub_sub_sub_category",displayName:"Tertiary Sub Category",width:125,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"material",displayName:"Material Of Construction",width:150,pinnedLeft:!0,enableSorting:!0},{field:"grade",displayName:"Material Grade",width:125,pinnedLeft:!0,enableCellEdit:!1},{field:"specification",displayName:"Material Specification",width:125,pinnedLeft:!0,enableCellEdit:!1},{field:"dimension_a",displayName:"Dimension a",width:100,pinnedLeft:!0,enableCellEdit:!1},{field:"unit_a",displayName:"Unit a",width:100,pinnedLeft:!0,enableCellEdit:!1},{field:"dimension_b",displayName:"Dimension b",width:100,pinnedLeft:!0,enableCellEdit:!1},{field:"unit_b",displayName:"Unit b",width:100,pinnedLeft:!0,enableCellEdit:!1},{field:"dimension_c",displayName:"Dimension c",width:100,pinnedLeft:!0,enableCellEdit:!0},{field:"unit_c",displayName:"Unit c",width:100,pinnedLeft:!0,enableCellEdit:!1},{field:"total_quantity",displayName:"Total Quantity",width:125,pinnedLeft:!0,enableCellEdit:!1},{field:"quantity_ordered",displayName:"Quantity Ordered",width:125,pinnedLeft:!0,enableCellEdit:!1},{field:"quantity_remaining",displayName:"Remaining Quantity",width:125,pinnedLeft:!0,enableCellEdit:!1},{field:"unit_measure",displayName:"Unit of Measure",width:150,pinnedLeft:!0,enableCellEdit:!1},{field:"buyer_notes",displayName:"Buyer Notes",width:150,pinnedLeft:!0,enableCellEdit:!1}]},"onRegisterApi",function(registeredApi){$scope.gridApi=registeredApi}),$scope.exportCsv=function(){var grid=$scope.gridApi.grid,rowTypes=uiGridExporterConstants.ALL,colTypes=uiGridExporterConstants.ALL;uiGridExporterService.csvExport(grid,rowTypes,colTypes)}}])}();