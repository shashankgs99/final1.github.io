"use strict";!function(){var app=angular.module("app");app.controller("messagesController",["$scope","MessageService","$window","$modal","$log","$state","InventoryService","DirectoryService",function($scope,MessageService,$window,$modal,$log,$state,InventoryService,DirectoryService){function open(size,message,tabCount,itemCount,closeOnClick){var params={templateUrl:"popup.html",resolve:{items:function(){return $scope.items}},controller:function($scope,$modalInstance,items){if(2==tabCount&&($scope.secondTab=!0),message.inventory.length)if(message.inventory.length>1){$scope.multipleProducts=!0;var data=message.inventory;data.forEach(function(item){console.log(item),$scope.itemData=[],InventoryService.getOne(parseInt(item)).then(function(inventory){$scope.itemData.push(inventory.data)})})}else $scope.multipleProducts=!1,InventoryService.getOne(parseInt(message.inventory[0])).then(function(inventory){$scope.itemData=inventory.data});else message.directory.length&&DirectoryService.getOne(parseInt(message.directory[0])).then(function(directory){$scope.itemData=directory.data});if($scope.selectedMessage=message,$scope.selectedMessage.attachments[0]){var splitAttachment=$scope.selectedMessage.attachments[0].split("/");$scope.attachmentName=splitAttachment.pop()}$scope.reposition=function(){$modalInstance.reposition()},$scope.ok=function(){$modalInstance.close()},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.openNested=function(){open()}}};angular.isDefined(closeOnClick)&&(params.closeOnClick=closeOnClick),angular.isDefined(size)&&(params.size=size);var modalInstance=$modal.open(params);modalInstance.result.then(function(selectedItem){$scope.selected=selectedItem},function(){$log.info("Modal dismissed at: "+new Date)})}$scope.current_user.data.is_admin_supplier&&$scope.current_user.data.company&&MessageService.get({supplier_company:$scope.current_user.data.company.id}).then(function(data){console.log(data.data.results),$scope.messagesData=data.data.results},function(err){console.log(err)}),$scope.current_user.data.id&&MessageService.get({sender:$scope.current_user.data.id}).then(function(data){console.log(data.data.results),$scope.sentMessagesData=data.data.results},function(err){console.log(err)});$scope.current_user.data.title;$scope.tab=1,$scope.setTab=function(tabId){$scope.tab=tabId},$scope.isSet=function(tabId){return $scope.tab===tabId},$scope.open=open}])}();