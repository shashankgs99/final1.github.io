"use strict";!function(){var app=angular.module("app");app.controller("register.controller",["$scope","$interval","$location","$window","$timeout","$state","$stateParams","UserService","$ocLazyLoad",function($scope,$interval,$location,$window,$timeout,$state,$stateParams,UserService,$ocLazyLoad){var username=null,id=null;$scope.update={role_type:[]},$scope.additionalData=[],$scope.current_user||($scope.current_user={}),$scope.dropdownSettings={scrollableHeight:"200px",scrollable:!0},UserService.getRoleTypes().then(function(data){data.data.count>0&&($scope.additionalData=data.data.results.map(function(item){return{id:item.id,label:item.role_type_name}}))}),$stateParams.username&&(username=$stateParams.username,id=$stateParams.id),$scope.current_user.data&&$scope.current_user.data.username||UserService.getCurrentUser().then(function(data){$scope.current_user.data=data.data,$scope.update={username:$scope.current_user.data.username,first_name:$scope.current_user.data.first_name,last_name:$scope.current_user.data.last_name,email:$scope.current_user.data.email}})["catch"](function(response){}),$scope.current_user.data&&$scope.current_user.data.username&&(username=$scope.current_user.data.username,id=$scope.current_user.data.id),$scope.current_user.register=function(data,valid_data){if($scope.error={},valid_data){username=data.username;data.password;UserService.post(data).then(function(data){$state.go("register.step2",{username:username,id:data.data.id},{reload:!0})},function(err){$scope.error=err.data})}},$scope.current_user.update=function(data,valid_data,state){if($scope.success=!1,valid_data){if($scope.current_user.data&&$scope.current_user.data.email){var email=$scope.current_user.data.email;data.email==email&&delete data.email}id||(id=$scope.current_user.data.id),data.role_type&&(data.role_type=data.role_type.map(function(item){return item.id})),UserService.update(id,data).then(function(data){$scope.success=!0,$timeout(function(){if(state)$state.go(state,{},{reload:!0});else{var url="/login";$window.location.assign(url)}},3e3)},function(err){$scope.error=err.data,console.log(err)})}},$scope.current_user.skip=function(data,valid_data,state){var url="/login";$window.location.assign(url)}}])}();