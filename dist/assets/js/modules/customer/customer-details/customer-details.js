"use strict";!function(){var app=angular.module("app");app.controller("customerCompanyController",["$scope","$window","$modal","$log","$state","Notification","CustomerService","$stateParams","BankService","TaxService",function($scope,$window,$modal,$log,$state,Notification,CustomerService,$stateParams,BankService,TaxService){$scope.hide=!1,$scope.supplierDetails=!1,$scope.customerDetails=!1,$scope.taxData=[],$scope.bankData=[],$scope.taxTypeList=[],$state.current.name.includes("buyerDashboard.suppliers.viewCompany")?($scope.hide=!0,$scope.type="Supplier"):$scope.type="Customer",$state.current.name.includes("buyerDashboard.suppliers.viewCompany")&&($scope.customerDetails=!0),$state.current.name.includes("supplierDashboard.customers.viewCompany")&&($scope.supplierDetails=!0),$scope.viewOffer=function(data){var emails=[],supplier=[];if(data&&data.contacts.length){var contactsInfo=data.contacts;contactsInfo.map(function(item){item.emailid1&&(emails.push(item.emailid1),supplier.push({id:data.id,name:data.name})),item.emailid2&&(emails.push(item.emailid2),supplier.push({id:data.id,name:data.name}))})}supplier=_.uniqBy(supplier,"id"),emails=_.uniq(emails),$state.go("buyerDashboard.offers.List",{emails:emails,supplier:supplier[0]})},$scope.viewContacts=function(info){var data=[];data.push(info),$state.current.name.includes("supplierDashboard")?$state.go("supplierDashboard.customers.viewContacts",{data:data,companyId:data[0].id}):$state.go("buyerDashboard.suppliers.viewContacts",{data:data,companyId:data[0].id})},$scope.viewProjectsDetails=function(res){var data=[];if(data.push(res),data){data[0].role_type;$state.current.name.includes("adminDashboard")?$state.go("adminDashboard.projects.list",{customer:data[0]}):$state.go("supplierDashboard.projects.list",{customer:data[0]})}},$stateParams.companyId&&(BankService.get({customer:$stateParams.companyId}).then(function(result){result.data.results.length&&($scope.bankData=result.data.results)}),TaxService.get({customer:$stateParams.companyId}).then(function(res){$scope.taxData=res.data.results,$scope.taxData=$scope.taxData.map(function(item){return item.tax_type&&$scope.taxTypeList.length&&$scope.taxTypeList.map(function(tax){item.tax_type===tax.id&&(item.taxType=tax)}),item})}),CustomerService.getOne($stateParams.companyId).then(function(data){$scope.companyData=data.data})),TaxService.getTaxTypes().then(function(data){$scope.taxTypeList=data.data.results,$scope.taxData.length&&$scope.taxData.map(function(item){$scope.taxTypeList.map(function(tax){item.tax_type===tax.id&&(item.taxType=tax)})})}),$scope.viewProjects=function(table_changes){return 0===table_changes.length?void Notification.error({message:"Please select atleast one item to view company",positionX:"right",positionY:"top"}):table_changes.length>1?void Notification.error({message:"Please select only one item to view company",positionX:"right",positionY:"top"}):void($state.current.name.includes("customers")?$state.current.name.includes("adminDashboard")?$state.go("adminDashboard.customers.viewProjects",{clientId:table_changes.id,type:table_changes.role_type[0]}):$state.go("buyerDashboard.customers.viewProjects",{clientId:table_changes.id,type:table_changes.role_type[0]}):$state.current.name.includes("suppliers")&&$state.go("buyerDashboard.suppliers.viewProjects",{clientId:table_changes.id,type:table_changes.role_type[0]}))},$scope.cancel=function(){$state.current.name.includes("customers")?$state.current.name.includes("adminDashboard")?$state.go("adminDashboard.customers.list"):$state.go("supplierDashboard.customers.list"):$state.current.name.includes("suppliers")&&$state.go("buyerDashboard.suppliers.list")},$scope.editCustomer=function(data){$state.current.name.includes("customers")?$state.current.name.includes("adminDashboard")?$state.go("adminDashboard.customers.edit",{customerId:data.id}):$state.go("supplierDashboard.customers.edit",{customerId:data.id}):$state.current.name.includes("suppliers")&&$state.go("buyerDashboard.suppliers.edit",{customerId:data.id})},$scope.ListPage=function(){$state.current.name.includes("customers")?$state.current.name.includes("adminDashboard")?$state.go("adminDashboard.customers.list"):$state.go("supplierDashboard.customers.list"):$state.current.name.includes("suppliers")&&$state.go("buyerDashboard.suppliers.list")}}])}();