<div layout="row" layout-sm="column" ng-if="showLoader" layout-align="space-around" class="loader">
    <md-progress-circular md-mode="indeterminate" class="loader-2"></md-progress-circular>
</div>
<div layout="column" layout-align="start center" layout-xs="row" layout-wrap>
    <div layout="column" class="main-card">
        <div layout="row" layout-align="start center" layout-margin class="layout-padding md-display-1">
            {[{name}]}
        </div>
        <div layout="row">
            <div layout="column" flex>
                <div class="md-whiteframe-1dp card-background">
                    <div class="md-title" layout-margin layout-padding>Basic Details</div>
                    <div layout-margin>
                        <div layout="row" layout-xs="column">
                            <div flex="50" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Customer Name</label>
                                    <input required name="name" ng-model="customer.name">
                                    <div ng-messages="customerForm.name.$error">
                                        <div ng-message="required">This is required.</div>
                                    </div>
                                </md-input-container>
                            </div>
                            <div flex="50" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Website</label>
                                    <input name="website" ng-model="customer.website">
                                </md-input-container>
                            </div>
                        </div>
                        <div layout="row" layout-xs="column">
                            <div flex="50" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Company Size</label>
                                    <md-select ng-model="customer.company_type">
                                        <md-option ng-repeat="item in companyTypes track by $index"
                                            ng-value="item.company_type_name">
                                            {[{item.company_type_name}]}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                            <div flex="50" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Role Type</label>
                                    <md-select ng-model="customer.role_type" ng-disabled="disabled" required>
                                        <md-option ng-repeat="role in roleTypes track by $index" ng-value="role">
                                            {[{role.label}]}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                        </div>
                        <div layout="row" ng-if="customer.company_type === 'Others(specify)'" layout-xs="column">
                            <md-input-container class="md-block" flex="50" flex-xs="100">
                                <label>Company Type Other</label>
                                <input required name="company_type_other" ng-model="customer.company_type_other">
                            </md-input-container>
                        </div>
                        <div layout="row" layout-xs="column">
                            <div flex="50" flex-xs="100" layout="row">
                                <div flex="20" flex-xs="30">
                                    <md-input-container class="md-block md-input-invalid">
                                        <label for="countryCode1">Country Code1</label>
                                        <input type="text" name="countryCode1" ng-model="customer.countryCode1">
                                    </md-input-container>
                                </div>
                                <div flex flex-xs="70">
                                    <md-input-container class="md-block md-input-invalid">
                                        <label for="phonenumber"> Phone Number1</label>
                                        <input type="text" name="phonenumber1" ng-model="customer.phonenumber1">
                                    </md-input-container>
                                </div>
                            </div>
                            <div flex="50" flex-xs="100" layout="row">
                                <div flex="20" flex-xs="30">
                                    <md-input-container class="md-block md-input-invalid">
                                        <label for="countryCode2">Country Code2</label>
                                        <input type="text" name="countryCode2" ng-model="customer.countryCode2">
                                    </md-input-container>
                                </div>
                                <div flex flex-xs="70">
                                    <md-input-container class="md-block  md-input-invalid">
                                        <label for="phonenumber2"> Phone Number2</label>
                                        <input type="text" name="phonenumber2" ng-model="customer.phonenumber2">
                                    </md-input-container>
                                </div>
                            </div>
                        </div>
                        <div layout="row" layout-xs="column">
                            <div flex="50" flex-xs="100">
                                <md-input-container class="md-block md-input-invalid">
                                    <label for="emailid1">Email Id1</label>
                                    <input type="text" name="emailid1" ng-model="customer.emailid1">
                                </md-input-container>
                            </div>
                            <div flex="50" flex-xs="100">
                                <md-input-container class="md-block md-input-invalid">
                                    <label for="emailid2"> Email id 2</label>
                                    <input type="text" name="emailid2" ng-model="customer.emailid2">
                                </md-input-container>
                            </div>
                        </div>
                        <div layout="row" layout-xs="column">
                            <div flex="50" flex-xs="100" layout-margin>
                                <div layout="row" layout-xs="column">
                                    <label for="logo">logo</label>
                                </div>
                                <div layout="row" layout-xs="column">
                                    <input type="file" id="customer-logo" valid-file upload="uploadLogo(file,$index)" />
                                </div>
                            </div>
                            <div flex="50"></div>
                        </div>
                    </div>
                </div>
                <div class="md-whiteframe-1dp card-background margin-top-2">
                    <div layout="row">
                        <div flex="95">
                            <div class="md-title" layout-margin layout-padding>Categories</div>
                        </div>
                        <div flex>
                            <i class="fa fa-plus-square-o fa-lg margin-t-32" aria-hidden="true" title="Add Category"
                                ng-click="AddCategories()"></i>
                        </div>
                    </div>
                    <div layout="column" ng-if="customer.categories.length" layout-xs="row">
                        <div layout="column" ng-repeat="item in customer.categories track by $index" layout-xs="row">
                            <div layout="row" layout-xs="column" layout-margin>
                                <div flex="20" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column" layout-xs="column">
                                        <label class="md-caption"> Category Name</label>
                                        <span class="md-body-1">{[{item.parent_category ? item.parent_category :
                                            'NA'}]}</span>
                                    </div>
                                </div>
                                <div flex="20" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column" layout-xs="column">
                                        <label class="md-caption">Sub Category</label>
                                        <span class="md-body-1">{[{item.sub_category ? item.sub_category :
                                            'NA'}]}</span>
                                    </div>
                                </div>
                                <div flex="20" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column" layout-xs="column">
                                        <label class="md-caption">Secondary Sub Category</label>
                                        <span class="md-body-1">{[{item.sub_sub_category ? item.sub_sub_category :
                                            'NA'}]}</span>
                                    </div>
                                </div>
                                <div flex="20" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column" layout-xs="column">
                                        <label class="md-caption">Tertiary Sub Category</label>
                                        <span class="md-body-1">{[{item.sub_sub_sub_category ? item.sub_sub_sub_category
                                            :
                                            'NA'}]}</span>
                                    </div>
                                </div>
                                <div layout="row">
                                    <i class="fa fa-times-circle icon-cog customer-remove-icon category-icon" aria-hidden="true"
                                        title="Remove" ng-click="removeUploadedCategories($index)"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div ng-repeat="category in selectedCategories" ng-if="selectedCategories.length">
                        <div layout="row" layout-xs="column">
                            <div flex="20" flex-xs="100" layout-margin>
                                <md-autocomplete class="ml-margin-l-4" flex md-input-name="autocompleteField"
                                    md-input-minlength="2" md-input-maxlength="18" md-no-cache="noCache"
                                    md-selected-item="category.category_name"
                                    md-selected-item-change="selectedCategory(item,category)"
                                    md-search-text="searchText" md-items="item in querySearch(searchText)"
                                    md-item-text="item.parentCategory" md-require-match
                                    md-floating-label="Category Name">
                                    <md-item-template>
                                        <span md-highlight-text="searchText">{{item.parentCategory}}</span>
                                    </md-item-template>
                                </md-autocomplete>
                            </div>
                            <div flex="20" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Sub-Categories</label>
                                    <md-select ng-model="category.sub_category"
                                        ng-change="selectedSubCategory(category.sub_category)">
                                        <md-option ng-repeat="subcategory in subcategories track by $index"
                                            ng-value="subcategory">
                                            {[{subcategory}]}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                            <div flex="20" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Secondary Sub Category</label>
                                    <md-select ng-model="category.sub_sub_category"
                                        ng-change="selectedSubSubCategory(category.sub_sub_category)">
                                        <md-option ng-repeat="category in subsubcategories" ng-value="category">
                                            {[{category}]}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                            <div flex="20" flex-xs="100">
                                <md-input-container class="md-block">
                                    <label>Teritary Sub Category</label>
                                    <md-select ng-model="category.sub_sub_sub_category">
                                        <md-option ng-repeat="category in subsubsubcategories" ng-value="category">
                                            {[{category}]}
                                        </md-option>
                                    </md-select>
                                </md-input-container>
                            </div>
                            <span layout="row" class="icon-pos">
                                <i ng-if="category.show" class="fa fa-plus-square-o fa-lg" aria-hidden="true"
                                    title="Add New Category" ng-click="AddNewCategories(category)"></i>
                                <i class="fa fa-times-circle fa-lg fa-fw rm-icon" aria-hidden="true" title="Remove"
                                    ng-click="remove($index,category.newCategories)"></i>
                            </span>
                        </div>
                        <div ng-repeat="info in category.newCategories">
                            <div layout="row" layout-xs="column" layout-margin>
                                <div flex="20" flex-xs="100">
                                    <md-input-container class="md-block">
                                        <label>Category</label>
                                        <input ng-model="info.parent_category">
                                    </md-input-container>
                                </div>
                                <div flex="20" flex-xs="100">
                                    <md-input-container class="md-block">
                                        <label>Sub Category</label>
                                        <input ng-model="info.sub_category">
                                    </md-input-container>
                                </div>
                                <div flex="20" flex-xs="100">
                                    <md-input-container class="md-block">
                                        <label>Secondary Sub Category</label>
                                        <input ng-model="info.sub_sub_category">
                                    </md-input-container>
                                </div>
                                <div flex="20" flex-xs="100">
                                    <md-input-container class="md-block">
                                        <label>Teritary Sub Category</label>
                                        <input ng-model="info.sub_sub_sub_category">
                                    </md-input-container>
                                </div>
                                <span layout="row" class="icon-pos">
                                        <i class="fa fa-times-circle fa-lg contact-icon fa-fw rm-icon" aria-hidden="true" title="Remove"
                                        ng-click="removecategory($index,category.newCategories)"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="md-whiteframe-1dp card-background margin-top-2">
                    <div layout="row">
                        <div flex="95">
                            <div class="md-title" layout-margin layout-padding>Contacts</div>
                        </div>
                        <div flex>
                            <i class="fa fa-plus-square-o fa-lg margin-t-32" aria-hidden="true" title="Add Contact"
                                ng-click="AddContact()"></i>
                        </div>
                    </div>
                    <div layout="column" ng-if="contactList.length" layout-margin>
                        <div layout="column" ng-repeat="contact in contactList track by $index"
                            ng-click="EditContact($event,contact,$index)" layout-margin>
                            <div layout="row" layout-xs="column" layout-margin>
                                <div flex="30" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                        <label class="md-caption"> Name</label>
                                        <span class="md-body-1">{[{contact.firstname}]} {[{contact.lastname}]}</span>
                                    </div>
                                </div>
                                <div flex="30" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                        <label class="md-caption">Phone Number</label>
                                        <span class="md-body-1">{[{contact.countryCode1}]} {[{contact.phonenumber1}]}</span>
                                    </div>
                                </div>
                                <div flex="30" flex-xs="100">
                                    <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                        <label class="md-caption">Email ID 1</label>
                                        <span class="md-body-1" ng-bind="contact.emailid1"></span>
                                    </div>
                                </div>
                                <div layout="row" flex-xs="100">
                                    <i class="fa fa-times-circle icon-cog contact-icon customer-remove-icon" aria-hidden="true" title="Remove"
                                        ng-click="removeContact(contactList,$index)"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="md-whiteframe-1dp card-background margin-top-2">
                    <div layout="row">
                        <div flex="95">
                            <div class="md-title" layout-margin layout-padding>Addresses</div>
                        </div>
                        <div flex>
                            <i class="fa fa-plus-square-o fa-lg margin-t-32" aria-hidden="true" title="Add Addresses" ng-click="CreateAddress($event)"></i>
                        </div>
                    </div>
                    <div layout="column" ng-repeat="address in addresses track by $index" ng-click="EditAddress($event,address,$index)" layout-margin>
                        <div layout="row" layout-xs="column" layout-margin>
                            <div flex="30" flex-xs="100">
                                <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                    <label class="md-caption"> Name of address</label>
                                    <span class="md-body-1">{[{address.nameofaddress}]}</span>
                                </div>
                            </div>
                            <div flex="30" flex-xs="100">
                                <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                    <label class="md-caption">City</label>
                                    <span class="md-body-1">{[{address.cityname}]}</span>
                                </div>
                            </div>
                            <div flex="30" flex-xs="100">
                                <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                    <label class="md-caption">State</label>
                                    <span class="md-body-1">{[{address.state}]}</span>
                                </div>
                            </div>
                            <div layout="row">
                                <i class="fa fa-times-circle icon-cog addr-icon customer-remove-icon" aria-hidden="true" title="Remove"
                                    ng-click="removeAddress($index)"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="md-whiteframe-1dp card-background margin-top-2" ng-if="customer.id">
                        <div layout="row">
                            <div flex="95">
                                <div class="md-title" layout-margin layout-padding>Tax Details</div>
                            </div>
                            <div flex>
                                <i class="fa fa-plus-square-o fa-lg margin-t-32" aria-hidden="true" title="Add Tax"
                                    ng-click="AddTax($event)"></i>
                            </div>
                        </div>
                        <div layout="column" ng-if="taxData.length" layout-margin>
                            <div layout="column" ng-repeat="tax in taxData track by $index" ng-click="EditTax($event,tax,$index)"
                                layout-margin>
                                <div layout="row" layout-xs="column" layout-margin>
                                    <div flex="30" flex-xs="100">
                                        <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                            <label class="md-caption"> Tax Type</label>
                                            <span class="md-body-1">{[{tax.taxType.name}]}</span>
                                        </div>
                                    </div>
                                    <div flex="30" flex-xs="100">
                                        <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                            <label class="md-caption">Number</label>
                                            <span class="md-body-1">{[{tax.number}]}</span>
                                        </div>
                                    </div>
                                    <div flex="30" flex-xs="100">
                                        <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                            <label class="md-caption">Issue Date</label>
                                            <span class="md-body-1" ng-bind="tax.issue_date"></span>
                                        </div>
                                    </div>
                                    <div layout="row" flex-xs="100">
                                        <i class="fa fa-times-circle icon-cog tax-icon customer-remove-icon" aria-hidden="true" title="Remove"
                                            ng-click="removeTaxDetails(taxData,$index)"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="md-whiteframe-1dp card-background margin-top-2" ng-if="customer.id">
                        <div layout="row">
                            <div flex="95">
                                <div class="md-title" layout-margin layout-padding>Bank Details</div>
                            </div>
                            <div flex>
                                <i class="fa fa-plus-square-o fa-lg margin-t-32" aria-hidden="true" title="Add BankDetails"
                                    ng-click="AddBankDetails($event)"></i>
                            </div>
                        </div>
                        <div layout="column" ng-if="bankData.length" layout-margin>
                            <div layout="column" ng-repeat="bank in bankData track by $index" ng-click="EditBankDetails($event,bank,$index)" layout-margin>
                                <div layout="row" layout-xs="column">
                                    <div flex="30" flex-xs="100">
                                        <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                            <label class="md-caption">Beneficiary Name</label>
                                            <span class="md-body-1">{[{bank.beneficiary_name}]}</span>
                                        </div>
                                    </div>
                                    <div flex="30" flex-xs="100">
                                        <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                            <label class="md-caption">Account Number</label>
                                            <span class="md-body-1">{[{bank.account_number}]}</span>
                                        </div>
                                    </div>
                                    <div flex="30" flex-xs="100">
                                        <div class="md-cr-input-block" flex flex-xs="100" layout="column">
                                            <label class="md-caption">Bank Name</label>
                                            <span class="md-body-1">{[{bank.bank_name}]}</span>
                                        </div>
                                    </div>
                                    <div layout="row">
                                        <i class="fa fa-times-circle icon-cog customer-remove-icon bank-icon" aria-hidden="true" title="Remove"
                                            ng-click="removeBankDetails(bank,$index)"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="md-whiteframe-1dp card-background margin-top-2">
                        <div layout="row">
                            <div class="md-title" layout-margin layout-padding>Attachments</div>
                        </div>
                        <div layout="row" layout-padding>
                            <label class="label-l" for="addFile">Add File (PDF, JPEG, PNG, DOCS)</label>
                        </div>
                        <div layout="row" layout-padding>
                            <input type="file" id="customer-attachment" valid-file
                                upload="uploadAttachmentsToS3(file,$index,'attachments')" />
                        </div>
                        <div ng-repeat="file in customerAttachments track by $index" class="margin-top-n-1 margin-l-2">
                          <div layout-margin>
                                {[{file.split('/').pop()}]}
                                <md-button class="md-icon-button">
                                    <md-icon class="material-icons catalog-clear" ng-click="removeAttachment(customerAttachments,$index)"
                                        title="Remove Attachment">clear</md-icon>
                                </md-button>
                          </div>
                        </div>
                        <div ng-repeat="file in existingAttachments" track by $index class="margin-top-n-1 margin-l-2">
                          <div layout-margin>
                                {[{file.split('/').pop()}]}
                                <md-button class="md-icon-button">
                                    <md-icon class="material-icons catalog-clear" ng-click="removeAttachments(existingAttachments, $index)"
                                        title="Remove Attachment">clear</md-icon>
                                </md-button>
                          </div>
                        </div>
                    </div>
                    <div class="md-whiteframe-1dp card-background margin-top-2">
                        <div layout="row">
                            <div class="md-title" layout-margin layout-padding>Catalogs</div>
                        </div>
                        <div layout="row" layout-padding>
                            <label class="label-l">Add File (PDF, JPEG, PNG, DOCS)</label>
                        </div>
                        <div layout="row" layout-padding>
                            <input type="file" id="customer-catelog" valid-file upload="uploadAttachmentsToS3(file,$index,'catalogs')" />
                        </div>
                        <div ng-repeat="file in customerCatalogs track by $index" class="margin-top-n-1 margin-l-2">
                           <div layout-margin>
                                {[{file.split('/').pop()}]}
                                <md-button class="md-icon-button">
                                    <md-icon class="material-icons catalog-clear" ng-click="removeCatalog(customerCatalogs,$index)"
                                        title="Remove Catelog">clear</md-icon>
                                </md-button>
                           </div>
                        </div>
                        <div ng-repeat="file in existingCatalogs" track by $index class="margin-top-n-1 margin-l-2">
                          <div layout-margin>
                                {[{file.split('/').pop()}]}
                                <md-button class="md-icon-button">
                                    <md-icon class="material-icons catalog-clear" ng-click="removeCatalogs(existingCatalogs, $index)"
                                        title="Remove Catelog">clear</md-icon>
                                </md-button>
                          </div>
                        </div>
                    </div>
                    <div layout="row" layout-align="end end" ng-if="!hideButtons" class="margin-b-5 margin-top-2">
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="cancelCustomerInternal()">Cancel</md-button>
                        <md-button class="md-primary md-raised cr-md-primary" ng-click="saveCustomer(customer,customerForm.$valid)"> Save
                        </md-button>
                    </div>
            </div>
        </div>
    </div>
</div>







