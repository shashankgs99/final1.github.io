"use strict";!function(){var app=angular.module("app");app.controller("TaxController",["$scope","$window","$log","$state","$http","$mdDialog","$dialogScope","s3Service","Notification","dateService",function($scope,$log,$window,$state,$http,$mdDialog,$dialogScope,s3Service,Notification,dateService){$dialogScope.taxInfo&&($scope.taxList=$dialogScope.taxInfo),$scope.taxTypeList=$dialogScope.taxTypeList,$dialogScope.tax&&($scope.tax=$dialogScope.tax),$scope.saveTax=function(data){return data.taxType?data.number?(data.tax_type=data.taxType.id,angular.isDate(data.validDate)&&(data.valid_date=dateService.convertDateToPython(data.validDate)),angular.isDate(data.issueDate)&&(data.issue_date=dateService.convertDateToPython(data.issueDate)),$dialogScope.companyId?data.company=$dialogScope.companyId:data.customer=$dialogScope.customerId,"Add"==$dialogScope.type&&$mdDialog.hide(data),$scope.tax&&"Modification"==$dialogScope.type&&(data.type="Modification",$mdDialog.hide(data)),void($scope.tax&&"Edit"==$dialogScope.type&&(data.type="Edit",$mdDialog.hide(data)))):void Notification.error({message:"Please enter number",positionX:"right",positionY:"top"}):void Notification.error({message:"Please Select Tax Type",positionX:"right",positionY:"top"})},$scope.checkTaxType=function(data){$scope.taxList&&$scope.taxList.length&&$scope.taxList.map(function(item){if(item.id==data.id)return Notification.error({message:"tax type is already exisited in tax details",positionX:"right",positionY:"top"}),void($scope.tax.taxType=null)})},$scope.cancel=function(){$mdDialog.cancel()},$scope.removeTaxDetails=function($index,details){$scope.taxData.splice($index,1),$scope.deleteTaxData.push(details)},$scope.uploadTaxUrl=function(file,details){var id;id=$dialogScope.companyId?$dialogScope.customerId:$dialogScope.customerId;var path="company/"+id+"/taxDetails";s3Service.uploadFile(path,file,function(url){details.url=url,Notification.success({message:"Successfully uploaded file",positionX:"right",positionY:"top"})})}}])}();