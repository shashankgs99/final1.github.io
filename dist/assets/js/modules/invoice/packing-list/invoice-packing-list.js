"use strict";!function(){var app=angular.module("app");app.controller("layout.invoice.PackingListController",["$scope","$window","$mdDialog","$log","$state","Notification","MessageService","$http","s3Service","dateService","$rootScope","$timeout","$stateParams","$dialogScope","$filter","InvoicePackingService",function($scope,$window,$mdDialog,$log,$state,Notification,MessageService,$http,s3Service,dateService,$rootScope,$timeout,$stateParams,$dialogScope,$filter,InvoicePackingService){function getRowId(row){return row.id}$dialogScope.items=$dialogScope.items.map(function(item,$index){return item.index=$index+1,item}),$scope.uiGridOptions={data:$dialogScope.items,enableCellEditOnFocus:!0,enableColumnResizing:!0,enableFiltering:!0,enableGridMenu:!0,showGridFooter:!0,showColumnFooter:!0,fastWatch:!0,rowIdentity:getRowId,getRowIdentity:getRowId,importerDataAddCallback:function(grid,newObjects){$scope.myData=$scope.data.concat(newObjects)},columnDefs:[{name:"checked",displayName:"",cellTemplate:'<input type="checkbox" ng-model="row.entity.checked">'},{name:"index",displayName:"#",width:50,pinnedLeft:!0,enableCellEdit:!1,enableSorting:!0},{field:"title",displayName:"Title",width:150,pinnedLeft:!0,enableCellEdit:!0,enableSorting:!0},{field:"details",displayName:"Details",width:200,pinnedLeft:!0,enableCellEdit:!0,enableSorting:!0},{field:"quantity",displayName:"Quantity",width:150,pinnedLeft:!0,enableCellEdit:!0,enableSorting:!0},{field:"units",displayName:"Units",width:150,pinnedLeft:!0,enableCellEdit:!0,enableSorting:!0},{field:"packing",displayName:"Packing",width:150,pinnedLeft:!0,enableCellEdit:!0,enableSorting:!0},{field:"dimensions",displayName:"Dimensions",width:150,pinnedLeft:!0,enableSorting:!0,enableCellEdit:!1},{field:"net_weight",displayName:"Net Weight",width:150,pinnedLeft:!0,enableCellEdit:!0},{field:"gross_weight",displayName:"Gross Weight",width:150,pinnedLeft:!0,enableCellEdit:!0},{field:"remarks",displayName:"Remarks",width:150,pinnedLeft:!0,enableCellEdit:!0}],onRegisterApi:function(registeredApi){$scope.gridApi=registeredApi}},$scope.cancel=function(){$mdDialog.hide()},$scope.save=function(){var error,data=[];if($dialogScope.items.map(function(item){if(!error&&item.checked){if(!item.title)return Notification.error({message:"please enter title",positionX:"right",positionY:"top"}),void(error=!0);data.push(item)}}),data.length&&!error)InvoicePackingService.post(data).then(function(res){Notification.success({message:"Successfully saved",positionX:"right",positionY:"top"}),$mdDialog.hide()});else if(!data.length&&!error)return void Notification.error({message:"please select items",positionX:"right",positionY:"top"})},$scope.UpdatePackingList=function(ev){var data=[];return $scope.uiGridOptions.data.map(function(item){item.checked&&data.push(item)}),data.length?$mdDialog.show({controller:"layout.order.updateGRNItems",templateUrl:"assets/js/modules/po/GRN/update-grn-details/update-grn-details.html",parent:angular.element(document.body),targetEvent:ev,multiple:!0,clickOutsideToClose:!0,locals:{$dialogScope:{display:"packingList"}}}).then(function(res){res&&($scope.uiGridOptions.data=$scope.uiGridOptions.data.map(function(item){return item.checked&&(res&&res.packing_packing&&(item.modified=!0,item.packing=res.packing_packing),res&&res.packing_dimenssion&&(item.modified=!0,item.dimensions=res.packing_dimenssion),res&&res.packing_net_weight&&(item.modified=!0,item.net_weight=res.packing_net_weight),res&&res.packing_gross_weight&&(item.modified=!0,item.gross_weight=res.packing_gross_weight),res&&res.packing_remarks&&(item.modified=!0,item.remarks=res.packing_remarks)),item}))}):void Notification.error({message:"please select items",positionX:"right",positionY:"top"})},$scope.selectAll=function(data){data?$scope.uiGridOptions.data=$scope.uiGridOptions.data.map(function(item){return item.checked=!1,item}):$scope.uiGridOptions.data=$scope.uiGridOptions.data.map(function(item){return item.checked=!0,item})}}])}();