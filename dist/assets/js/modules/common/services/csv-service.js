"use strict";!function(){var app=angular.module("app");app.factory("CsvService",["$injector",function($scope,$injector){function mapFieldNames(fieldNames,serviceName){var mappedFields=[];return"InventoryService"===serviceName||"DirectoryService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),"category"===field?field="category_name":field.includes("secondary")?field="sub_sub_category":field.includes("tertiary")?field="sub_sub_sub_category":field.includes("sub")?field="sub_category":field.includes("construction")?field="material":field.includes("grade")?field="grade":field.includes("standard")?field="standard":field.includes("measure")?field="unit_of_measure":field.includes("price")?field="unit_price":field.includes("a(x)")?field="a_b_c":field.includes("dimension")&&field.includes("a")?field="dimension_a":field.includes("dimension")&&field.includes("b")?field="dimension_b":field.includes("dimension")&&field.includes("c")?field="dimension_c":field.includes("unit")&&field.includes("a")?field="unit_a":field.includes("unit")&&field.includes("b")?field="unit_b":field.includes("unit")&&field.includes("c")?field="unit_c":field.includes("total")?field="total_quantity":field.includes("sold")?field="quantity_sold":field.includes("available")?field="available_quantity":field.includes("manufacturer")?field="manufacturer_company":field.includes("rental")?field="rental_period":field.includes("supplier")?field="supplier_company":field.includes("country")?field="country":field.includes("state")?field="state":field.includes("city")&&(field="city_draft"),mappedFields.push(field)}),mappedFields):"UserService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("password")?field="password":field.includes("superuser")?field="is_superuser":field.includes("first")&&field.includes("name")?field="first_name":field.includes("company")&&field.includes("name")?field="company":field.includes("last")&&field.includes("name")?field="last_name":field.includes("staff")?field="is_staff":field.includes("active")?field="is_active":field.includes("username")?field="username":field.includes("email")&&field.includes("verified")?field="is_email_verified":field.includes("email")&&field.includes("verificationhash")?field="email_verification_hash":field.includes("email")?field="email":field.includes("avatar")?field="avatar":field.includes("image")?field="image":field.includes("buyer")?field="is_buyer":field.includes("supplier")&&field.includes("admin")?field="is_admin_supplier":field.includes("supplier")?field="is_seller":field.includes("verified")?field="is_verified":field.includes("phone")?field="contact_no":field.includes("country")&&field.includes("code")?field="country_code":field.includes("created")?field="created":field.includes("city")?field="location_city":field.includes("country")&&(field="location_country"),mappedFields.push(field)}),mappedFields):"CompanyService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("supplier")&&field.includes("name")?field="company_name":field.includes("logo")?field="logo":field.includes("website")?field="website":field.includes("about")&&field.includes("us")&&field.includes("text")?field="aboutus_text":field.includes("about")&&field.includes("us")?field="aboutus_text":field.includes("currency")?field="profit_currency":field.includes("establishment")&&field.includes("type")?field="establishment_type":field.includes("establishment")&&field.includes("type")&&field.includes("other")?field="establishment_type_other":field.includes("company")&&field.includes("type")?field="company_type":field.includes("role")&&field.includes("type")?field="role_type":field.includes("company")&&field.includes("type")&&field.includes("other")?field="company_type_other":field.includes("seller")?field="is_seller":field.includes("buyer")?field="is_buyer":field.includes("establishment")&&field.includes("year")?field="establishment_year":field.includes("revenue")?field="revenue":field.includes("revenue")&&field.includes("year")?field="revenue_year":field.includes("profit")?field="profit":field.includes("financial")&&field.includes("year")?field="financial_year":field.includes("contact")&&field.includes("person")&&field.includes("email")?field="emailid1":field.includes("contact")&&field.includes("person")&&field.includes("number")&&field.includes("1")?field="phonenumber1":field.includes("contact")&&field.includes("person")&&field.includes("number")&&field.includes("2")?field="phonenumber2":field.includes("address")?field="address":field.includes("city")?field="city":field.includes("state")?field="state":field.includes("country")&&(field="country"),mappedFields.push(field)}),mappedFields):"MessageService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("item")&&field.includes("title")?field="title":field.includes("description")?field="description":field.includes("unit")&&field.includes("price")?field="unit_price":field.includes("tertiary")&&field.includes("sub")&&field.includes("category")?field="sub_sub_sub_category":field.includes("secondary")&&field.includes("sub")&&field.includes("category")?field="sub_sub_category":field.includes("sub")&&field.includes("category")?field="sub_category":field.includes("category")?field="category":field.includes("unit")&&field.includes("of")&&field.includes("measure")?field="unit_measure":field.includes("material")&&field.includes("of")&&field.includes("construction")?field="material":field.includes("material")&&field.includes("grade")?field="grade":field.includes("dimension")&&field.includes("a")?field="dimension_a":field.includes("dimension")&&field.includes("b")?field="dimension_b":field.includes("dimension")&&field.includes("c")?field="dimension_c":field.includes("unit")&&field.includes("a")?field="unit_a":field.includes("unit")&&field.includes("b")?field="unit_b":field.includes("unit")&&field.includes("c")?field="unit_c":field.includes("material")&&field.includes("specification")&&field.includes("standard")?field="specification":field.includes("total")&&field.includes("quantity")?field="total_quantity":field.includes("buyer")&&field.includes("notes")?field="buyer_notes":field.includes("quantity")&&field.includes("offered")?field="quantity_offered":field.includes("total")&&field.includes("price")?field="total_price":field.includes("price")&&field.includes("basis")?field="price_basis":field.includes("currency")?field="currency":field.includes("delivery")&&field.includes("basis")?field="deliver_basis":field.includes("delivery")?field="delivery":field.includes("supplier")&&field.includes("notes")&&(field="supplier_notes"),mappedFields.push(field)}),mappedFields):"MTOService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("item")&&field.includes("title")?field="title":field.includes("description")?field="description":field.includes("unit")&&field.includes("price")?field="unit_price":field.includes("tertiary")&&field.includes("sub")&&field.includes("category")?field="sub_sub_sub_category":field.includes("secondary")&&field.includes("sub")&&field.includes("category")?field="sub_sub_category":field.includes("sub")&&field.includes("category")?field="sub_category":field.includes("category")?field="category":field.includes("unit")&&field.includes("of")&&field.includes("measure")?field="unit_measure":field.includes("material")&&field.includes("of")&&field.includes("construction")?field="material":field.includes("material")&&field.includes("grade")?field="grade":field.includes("dimension")&&field.includes("a")?field="dimension_a":field.includes("dimension")&&field.includes("b")?field="dimension_b":field.includes("dimension")&&field.includes("c")?field="dimension_c":field.includes("unit")&&field.includes("a")?field="unit_a":field.includes("unit")&&field.includes("b")?field="unit_b":field.includes("unit")&&field.includes("c")?field="unit_c":field.includes("material")&&field.includes("specification")&&field.includes("standard")?field="specification":field.includes("total")&&field.includes("quantity")?field="total_quantity":field.includes("buyer")&&field.includes("notes")?field="buyer_notes":field.includes("quantity")&&field.includes("offered")?field="quantity_offered":field.includes("total")&&field.includes("price")?field="total_price":field.includes("price")&&field.includes("basis")?field="price_basis":field.includes("currency")?field="currency":field.includes("delivery")&&field.includes("basis")?field="deliver_basis":field.includes("delivery")?field="delivery":field.includes("supplier")&&field.includes("notes")&&(field="supplier_notes"),mappedFields.push(field)}),mappedFields):"CustomerService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("customer")&&field.includes("name")?field="name":field.includes("supplier")&&field.includes("name")?field="name":field.includes("website")?field="website":field.includes("company")&&field.includes("size")?field="company_type":field.includes("company")&&field.includes("type")?field="role_type":field.includes("company")&&field.includes("mobile")&&field.includes("country")&&field.includes("code")?field="countryCode1":field.includes("company")&&field.includes("mobile")&&field.includes("number")?field="phonenumber1":field.includes("company")&&field.includes("phone")&&field.includes("country")&&field.includes("code")?field="countryCode2":field.includes("company")&&field.includes("phone")&&field.includes("number")?field="phonenumber2":field.includes("company")&&field.includes("email")&&field.includes("1")?field="emailid1":field.includes("company")&&field.includes("email")&&field.includes("2")?field="emailid2":field.includes("fb")?field="facebook_url":field.includes("twitter")?field="twitter_url":field.includes("linkedin")?field="linkedin_url":field.includes("you")&&field.includes("tube")?field="youtube_url":field.includes("city")?field="city":field.includes("state")?field="state":field.includes("country")?field="country":field.includes("address")&&(field="addresses"),mappedFields.push(field)}),mappedFields):"CustomerContactService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("supplier")&&field.includes("name")?field="name":field.includes("customer")&&field.includes("name")?field="name":field.includes("contact")&&field.includes("person")&&field.includes("first")&&field.includes("name")?field="firstname":field.includes("contact")&&field.includes("person")&&field.includes("last")&&field.includes("name")?field="lastname":field.includes("contact")&&field.includes("person")&&field.includes("mobile")&&field.includes("country")&&field.includes("code")?field="countryCode1":field.includes("contact")&&field.includes("person")&&field.includes("mobile")?field="phonenumber1":field.includes("contact")&&field.includes("person")&&field.includes("phone")&&field.includes("country")&&field.includes("code")?field="countryCode2":field.includes("contact")&&field.includes("person")&&field.includes("phone")?field="phonenumber2":field.includes("contact")&&field.includes("person")&&field.includes("email")&&field.includes("1")?field="emailid1":field.includes("contact")&&field.includes("person")&&field.includes("email")&&field.includes("2")?field="emailid2":field.includes("address")?field="address":field.includes("city")?field="city":field.includes("state")?field="state":field.includes("country")&&(field="country"),mappedFields.push(field)}),mappedFields):"SupplierCategoryService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("supplier")&&field.includes("name")?field="name":field.includes("tertiary")&&field.includes("sub")&&field.includes("sub")?field="sub_sub_sub_category":field.includes("secondary")&&field.includes("sub")&&field.includes("sub")?field="sub_sub_category":field.includes("sub")&&field.includes("sub")?field="sub_category":field.includes("category")&&(field="parent_category"),mappedFields.push(field)}),mappedFields):"SalesOrderService"===serviceName?(fieldNames.forEach(function(field){field=field.toLowerCase(),field.includes("item")?field="title":field.includes("description")?field="description":field.includes("customer")&&field.includes("po")&&field.includes("s.no#")?field="customer_po_number":field.includes("buyer")&&field.includes("part")&&field.includes("number")?field="buyer_part_number":field.includes("supplier")&&field.includes("part")&&field.includes("number")?field="supplier_part_number":field.includes("quantity")&&field.includes("ordered")?field="quantity_ordered":field.includes("unit")&&field.includes("measure")?field="unit_measure":field.includes("unit")&&field.includes("price")?field="unit_price":field.includes("currency")?field="currency":field.includes("price")&&field.includes("basis")?field="price_basis":field.includes("delivery")&&field.includes("date")?field="delivery_date":field.includes("delivery")&&field.includes("basis")?field="delivery_basis":field.includes("sgst")?field="sgst":field.includes("cgst")?field="cgst":field.includes("igst")?field="igst":field.includes("vat")?field="vat":field.includes("other")&&field.includes("charges")&&(field="other_charges"),mappedFields.push(field)}),mappedFields):void 0}var factory={};return factory.importData=function(industry,item){$scope.itemType=item},factory.csvParser=function(strData,serviceName,supplier,strDelimiter,selectedIndustry){"DirectoryService"===serviceName&&($scope.supplier=supplier),strDelimiter=strDelimiter||",";for(var objPattern=new RegExp("(\\"+strDelimiter+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+strDelimiter+"\\r\\n]*))","gi"),arrData=[[]],arrMatches=null;arrMatches=objPattern.exec(strData);){var strMatchedDelimiter=arrMatches[1];strMatchedDelimiter.length&&strMatchedDelimiter!==strDelimiter&&arrData.push([]);var strMatchedValue;strMatchedValue=arrMatches[2]?arrMatches[2].replace(new RegExp('""',"g"),'"'):arrMatches[3],arrData[arrData.length-1].push(strMatchedValue)}var i,j,k,countBlankRows=0;for(j=0;j<arrData.length;j++){for(k=0;k<arrData[j].length;k++){var cell=arrData[j][k];if(""!==cell)break}if(k!==arrData[j].length)break;countBlankRows++}countBlankRows>0&&arrData.splice(0,countBlankRows);var countBlankColumns=0;for(i=0;i<arrData[0].length;i++){var cell=arrData[0][i];if(""!==cell)break;countBlankColumns++}countBlankColumns>0&&arrData.map(function(row){row.splice(0,countBlankColumns)});var fieldNames=angular.copy(arrData[0]);fieldNames=mapFieldNames(fieldNames,serviceName),arrData.splice(0,1);var data=[];for(j=0;j<arrData.length;j++){var obj={};for(k=0;k<arrData[j].length;k++)arrData[j][k]&&(arrData[j][k]&&(obj[fieldNames[k]]=arrData[j][k]),selectedIndustry&&(obj.industry=selectedIndustry.map(function(item){return item.id})),$scope.itemType&&(obj.stock_or_inventory=$scope.itemType),$scope.supplier&&(obj.supplier_company=$scope.supplier));data.push(obj)}return data},factory}])}();