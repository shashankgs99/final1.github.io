<div layout="column" layout-align="start center" class="md-padding md-margin" ng-cloak layout-wrap>
    <div layout="column" class="main-card" flex>
        <md-content>
            <div layout="column" layout-align="start center" class="md-margin">
                <p class="md-title"> SO #{[{order.so_number}]} Rev {[{order.revision_number}]} Dated {[{order.so_date}]}
                </p>
            </div>
            <md-button ng-click="ListPage()" class="md-icon-button so-back-arrow">
                <md-icon class="material-icons managecustomericon" title="Back to list">keyboard_backspace</md-icon>
            </md-button>
            <md-tabs md-dynamic-height md-border-bottom class="md-margin" md-selected="tabIndex" md-center-tabs="true" flex>
                <md-tab label="SO-Details" flex>
                    <div layout="column" layout-align="start center" class="md-padding md-margin">
                        <div layout="column" class="so-view-card" flex track by $index>
                            <div layout="row">
                                <span flex></span>
                                <div>
                                    <md-button class="md-icon-button" ng-click="changeStatus('Released',order)"
                                        title="Release">
                                        <md-icon class="material-icons managecustomericon">play_arrow_outline</md-icon>
                                    </md-button>
                                    <md-button class="md-icon-button" ng-click="changeStatus('Approved',order)"
                                        title="Approve" ng-disabled="showApprove">
                                        <md-icon class="material-icons managecustomericon">done</md-icon>
                                    </md-button>
                                </div>
                                <span flex></span>
                            </div>
                            <div layout="row" class="layout-padding md-title" layout-xs="column">
                                <div flex layout-xs="row" flex-xs="100"> Sales Order Details </div>
                                <span>
                                    <div layout-xs="row">
                                        <md-button class="md-icon-button" ng-click="EditOrder(order)">
                                            <md-icon class="material-icons managecustomericon" title="Edit Sales Order">edit
                                            </md-icon>
                                        </md-button>
                                        <md-button class="md-icon-button" ng-click="GenerateInvoice(order)">
                                            <md-icon class="material-icons managecustomericon" title="Generate Invoice">
                                                note_add</md-icon>
                                        </md-button>
                                        <md-button class="md-icon-button" ng-click="PrintSO(order)">
                                            <md-icon class="material-icons managecustomericon" title="Pinte Sales Order">
                                                print</md-icon>
                                        </md-button>
                                    </div>
                                </span>
                            </div>
                            <div layout="row">
                                <div layout="column" flex>
                                    <md-card md-theme-watch>
                                        <md-card-content>
                                            <div layout="column">
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">SO Number</label>
                                                        <p class="md-body-1" ng-bind="order.so_number">
                                                        </p> <span>Date :{[{order.so_date}]}</span>
                                                    </div>
                                                    <div flex>
                                                        <label class="md-caption">Supply Type</label>
                                                        <p class="md-body-1" ng-bind="order.so_supply_type.name"></p>
                                                    </div>

                                                </div>
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">Supplier Name</label>
                                                        <p class="md-body-1" ng-bind="order.supplier_name"></p>
                                                    </div>
                                                    <div flex>
                                                        <label class="md-caption">Project</label>
                                                        <p class="md-body-1" ng-bind="order.project.name"></p>
                                                    </div>

                                                </div>
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">Supplier Contact Details</label>
                                                        <p class="md-body-1">
                                                            {[{order.supplier_contact_name}]}
                                                            {[{","+order.supplier_contact_mobile}]}
                                                            {[{","+order.supplier_contact_email}]}
                                                        </p>
                                                    </div>
                                                    <div flex>
                                                        <label class="md-caption">Buyer Name</label>
                                                        <p class="md-body-1" ng-bind="order.buyer_company_name"></p>
                                                    </div>
                                                </div>
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">Authorized By</label>
                                                        <p class="md-body-1" ng-bind="order.authorized_by"></p>
                                                    </div>
                                                    <div flex>
                                                        <label class="md-caption">Buyer Contact Details</label>
                                                        <p class="md-body-1">
                                                            {[{order.buyer_contact_name}]}
                                                            {[{","+order.buyer_contact_mobile}]}
                                                            {[{","+order.buyer_contact_email}]}
                                                        </p>
                                                    </div>
                                                </div>
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">Buyer PO #</label>
                                                        <p class="md-body-1" ng-bind="order.buyer_po"></p>
                                                    </div>
                                                    <div flex>

                                                    </div>

                                                </div>
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">Delivery Date</label>
                                                        <p class="md-body-1" ng-bind="order.delivery_date"></p>
                                                    </div>
                                                    <div flex>
                                                        <label class="md-caption">Total Price</label>
                                                        <p class="md-body-1"> {[{order.currency}]}
                                                            {[{order.price_number}]}</p>
                                                    </div>
                                                </div>
                                                <div layout="row" flex layout-margin layout-xs="column">
                                                    <div flex>
                                                        <label class="md-caption">Delivery Basis</label>
                                                        <p class="md-body-1" ng-bind="order.delivery_basis"></p>
                                                    </div>
                                                    <div flex>
                                                        <label class="md-caption">Price Basis</label>
                                                        <p class="md-body-1" ng-bind="order.price_basis"></p>
                                                    </div>
                                                </div>
                                            </div>
                                        </md-card-content>
                                    </md-card>
                                </div>
                            </div>
                        </div>
                    </div>
                </md-tab>
                <md-tab label="Item Details" flex>
                    <div>
                        <p class="md-title md-margin md-padding">Item Details</p>
                        <md-content>
                            <div layout-margin>
                                <div id="SO-grid" ui-grid="uiGridOptions" class="grid" flex flex-xs="100"></div>
                            </div>
                        </md-content>
                    </div>
                </md-tab>
                <md-tab label="Invoice" flex>
                    <md-content>
                        <div layout="row" class="margin-t-1">
                            <div flex="75"></div>
                            <div flex>
                                <md-button class="md-icon-button" ng-click="GenerateInvoice(order)">
                                    <md-icon class="material-icons managecustomericon" title="Generate Invoicer">
                                        note_add</md-icon>
                                </md-button>
                            </div>
                        </div>
                        <div>
                            <md-content>
                                <div layout="column" layout-align="start center" class="md-margin md-padding">
                                    <div layout="column" class="so-view-card" flex
                                        ng-repeat="order in soInvoiceItems track by $index" track by $index>
                                        <div layout="row">
                                            <!-- <md-checkbox ng-model="selected" ng-change="selectedValue(order,$index,selected)"></md-checkbox> -->
                                            <div layout="column" flex>
                                                <md-card md-theme-watch ng-click="Viewinvoice(order)">
                                                    <md-card-content>
                                                        <div layout="column">
                                                            <div layout="row" flex layout-margin layout-xs="column">
                                                                <div flex="20" flex-xs="100">
                                                                    <label class="md-caption">Invoice Number#</label>
                                                                    <p class="md-body-1">{[{order.invoice_number}]}</p>
                                                                </div>
                                                                <div flex="20" flex-xs="100">
                                                                    <label class="md-caption">Invoice Type</label>
                                                                    <p class="md-body-1"
                                                                        ng-bind="order.invoice_type.name"></p>
                                                                </div>
                                                                <div flex="20" flex-xs="100">
                                                                    <label class="md-caption">Invoice Date</label>
                                                                    <p class="md-body-1">{[{order.invoice_date |
                                                                        date:'dd/MM/yyyy'}]}</p>
                                                                </div>
                                                                <div flex>
                                                                    <div flex>
                                                                        <label class="md-caption">Invoice Value</label>
                                                                        <p class="md-body-1">{[{order.so.currency}]}
                                                                            <span>{[{order.total_price_with_tax}]}</span>
                                                                        </p>
                                                                    </div>
                                                                </div>
                                                                <div flex>
                                                                    <label class="md-caption">Invoice State</label>
                                                                    <p class="md-body-1">{[{order.invoice_state.name}]}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </md-card-content>
                                                </md-card>
                                            </div>
                                        </div>
                                    </div>
                                    <pagination page="currentPage" total-items="count" max-size="maxSize"
                                        ng-if="paymentList.length" ng-click="setPage(currentPage)"
                                        boundary-links="true">
                                    </pagination>
                                </div>
                            </md-content>
                        </div>
                    </md-content>
                </md-tab>
                <md-tab label="Packing List">
                    <div id="SO-invoice-packinglist-grid" ui-grid="PLItems" class="grid" flex flex-xs="100"></div>
                </md-tab>
                <md-tab label="CashFlows" flex>
                    <md-content>
                        <div>
                            <p class="md-title md-margin md-padding"> Expected Payments</p>
                        </div>
                        <div layout="row" layout-margin>
                            <div flex="20"></div>
                            <div flex>
                                <p class="md-subhead">(a)Payments Made</p>
                            </div>
                            <div></div>
                        </div>
                        <div layout="column" layout-align="start center">
                            <div layout="column" class="so-view-card" flex track by $index>
                                <div layout="row">
                                    <div layout="column" flex>
                                        <md-card md-theme-watch
                                            ng-click="viewPaymentDetails($event,paidPaymentData,'payment-request')">
                                            <md-card-content>
                                                <div layout="row" layout-xs="column">
                                                    <div layout="column" flex layout-margin layout-gt-xs="row">
                                                        <div flex>
                                                            <label class="md-caption">Total Items</label>
                                                            <p class="md-body-1" ng-bind="paidPaymentData.length"></p>
                                                        </div>
                                                        <div flex></div>
                                                        <div flex>
                                                            <label class="md-caption">Total Price</label>
                                                            <p class="md-body-1" ng-bind="paidPaymentData.total_price">
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </md-card-content>
                                        </md-card>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div layout="row" layout-margin>
                            <div flex="20"></div>
                            <div flex>
                                <p class="md-subhead">(b)Payments Due</p>
                            </div>
                            <div></div>
                        </div>
                        <div layout="column" layout-align="start center">
                            <div layout="column" class="so-view-card" flex track by $index>
                                <div layout="row">
                                    <div layout="column" flex>
                                        <md-card md-theme-watch
                                            ng-click="viewPaymentDetails($event,pendingPaymentList,'payment-request')">
                                            <md-card-content>
                                                <div layout="row" layout-xs="column">
                                                    <div layout="column" flex layout-margin layout-gt-xs="row">
                                                        <div flex>
                                                            <label class="md-caption">Total Items</label>
                                                            <p class="md-body-1" ng-bind="pendingPaymentList.length">
                                                            </p>
                                                        </div>
                                                        <div flex></div>
                                                        <div flex>
                                                            <label class="md-caption">Total Price</label>
                                                            <p class="md-body-1"
                                                                ng-bind="pendingPaymentList.total_price"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </md-card-content>
                                        </md-card>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div layout="row" layout-margin>
                            <div flex="20"></div>
                            <div flex>
                                <p class="md-subhead">(c)Payments Due(Expected)</p>
                            </div>
                            <div></div>
                        </div>
                        <div layout="column" layout-align="start center">
                            <div layout="column" class="so-view-card" flex track by $index>
                                <div layout="row">
                                    <div layout="column" flex>
                                        <md-card md-theme-watch
                                            ng-click="viewPaymentDetails($event,PaymentsExpectedList)">
                                            <md-card-content>
                                                <div layout="row" layout-xs="column">
                                                    <div layout="column" flex layout-margin layout-gt-xs="row">
                                                        <div flex>
                                                            <label class="md-caption">Total Items</label>
                                                            <p class="md-body-1" ng-bind="PaymentsExpectedList.length">
                                                            </p>
                                                        </div>
                                                        <div flex></div>
                                                        <div flex>
                                                            <label class="md-caption">Total Price</label>
                                                            <p class="md-body-1"
                                                                ng-bind="PaymentsExpectedList.total_price"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </md-card-content>
                                        </md-card>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div layout="row" layout-margin></div>
                    </md-content>
                </md-tab>
            </md-tabs>
        </md-content>
    </div>
</div>