"use strict";!function(){var app=angular.module("app");app.controller("inventory.summary.categoryController",["$scope","$window","$timeout","ParentCategoryService","CategoryService","InventoryService","$stateParams","$state",function($scope,$window,$timeout,ParentCategoryService,CategoryService,InventoryService,$stateParams,$state){function getCategories(){InventoryService.getActiveCategories({itemType:$stateParams.rental?"Rental":"Stock"}).then(function(data){$scope.categories=_.groupBy(data.data,"parent_category");var categoryNames=Object.keys($scope.categories);$scope.categoryDataLoaded=!0;for(var i=0;i<categoryNames.length;i+=1)!function(i){var category=categoryNames[i];$timeout(function(){var params;params=$stateParams.rental?{category_name:category,stock_or_inventory:"Rental"}:{category_name:category,stock_or_inventory:{value:"Rental",operator:"!="}},InventoryService.getOutput(params).then(function(data){$scope.categories[category][0].inventories=data.data.results,$scope.categories[category][0].inventoriesLoaded="true"})},5e3)}(i)},function(err){console.log(err)})}$scope.categoryDataLoaded=!1;$scope.rental=$stateParams.rental,$stateParams.rental&&($scope.params=$stateParams.rental),getCategories();var skipClick=!1;$scope.openResults=function(category_name,sub_category){if(!skipClick){var url="";url+=$stateParams.rental?"/rental/list/category?q=&idx=Inventory&p=0&hFR[categories.lvl0][0]="+category_name:"/inventory/list/category?q=&idx=Inventory&p=0&hFR[categories.lvl0][0]="+category_name,sub_category&&(url+=" > "+sub_category),url+=$stateParams.rental?"&dFR[stock_or_inventory][0]=Rental":"&dFR[stock_or_inventory][0]=-Rental",window.open(url,"_self"),skipClick=!0}}}])}();