"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(){var app=angular.module("app");app.service("HandsonApiAdapter",["Miscellaneous",function(Miscellaneous){var service={};service.generateColHeaders=function(data){for(var first_record=data[0],colHeaders=Object.keys(first_record),i=0;i<colHeaders.length;i+=1)colHeaders[i]=Miscellaneous.humanize(colHeaders[i]);return colHeaders},service.generateColInfoArray=function(data,readOnly){var mapping={string:"text","boolean":"checkbox",number:"numeric"},first_record=data[0],colHeaders=Object.keys(first_record),colInfoArray=colHeaders.map(function(v){var dict={};return dict.width=100,dict.data=v,readOnly&&(dict.readOnly=!0),"url"!=v&&"id"!=v||(dict.readOnly=!0,dict.width=50),dict.type=mapping[_typeof(first_record[v])],dict});return colInfoArray};var getPkAsFistColumn=function(data){for(var new_data=[],i=0;i<data.length;i+=1)data[i].is_primary_key?new_data.unshift(data[i]):new_data.push(data[i]);return new_data},excludeFields=function(data,excludes){excludes=excludes.split(",");for(var new_data=[],i=0;i<data.length;i+=1){for(var exclude_flag=!1,j=0;j<excludes.length;j+=1)data[i].name==excludes[j]&&(exclude_flag=!0);exclude_flag||new_data.push(data[i])}return new_data},includeFields=function(data,includes){var field=JSON.parse(includes),new_data=[];return new_data=data,new_data.unshift(field),new_data};return service.generateColHeadersFromSchema=function(data,excludes,includes,serviceName,presentPage){if(data=getPkAsFistColumn(data),excludes&&(data=excludeFields(data,excludes)),includes&&(data=includeFields(data,includes)),"UserService"===serviceName){for(var col1=[],col2=[],i=0;i<data.length;i+=1)"is_superuser"===data[i].name||"is_staff"===data[i].name||"is_active"===data[i].name||"is_email_verified"===data[i].name||"image"===data[i].name||"is_seller"===data[i].name||"is_buyer"===data[i].name||"created"===data[i].name||"is_admin_supplier"===data[i].name||"is_verified"===data[i].name?col1.push(Miscellaneous.humanize(data[i].name)):"location_country"===data[i].name?col2.push("Country"):"location_city"===data[i].name?col2.push("City"):col2.push(Miscellaneous.humanize(data[i].name));col2.unshift(" ");var result=col2.concat(col1);return col2=result}if("CustomerService"===serviceName||"BuyerSupplierService"==serviceName){var colHeaders=[],col1=[],txt="";colHeaders.push(txt);for(var i=0;i<data.length;i+=1)"created_date"===data[i].name?col1.push(data[i].name):colHeaders.push(Miscellaneous.humanize(data[i].name));return colHeaders=colHeaders.concat(col1)}var colHeaders=[],txt="";colHeaders.push(txt);for(var i=0;i<data.length;i+=1)"sub_sub_category"===data[i].name?colHeaders.push("Secondary Sub Category"):"sub_sub_sub_category"===data[i].name?colHeaders.push("Tertiary Sub Category"):"stock_or_inventory"===data[i].name?colHeaders.push("Item type"):colHeaders.push(Miscellaneous.humanize(data[i].name));return colHeaders=colHeaders.concat(col1)},service.generateColInfoArrayFromSchema=function(data,readOnly,excludes,includes,serviceName,editData,presentPage,disableColumns){data=getPkAsFistColumn(data),excludes&&(data=excludeFields(data,excludes)),includes&&(data=includeFields(data,includes));var mapping={TextField:"text",CharField:"text",ForeignKey:"text",BooleanField:"checkbox",BigIntegerField:"numeric",IntegerField:"numeric",AutoField:"numeric",TimeField:"time",DateField:"date"};data.unshift({type:"BooleanField",name:"active"});var colInfoArray=data.map(function(v){var dict={};return dict.width=130,dict.data=v.name,dict.type="text",mapping[v.type]&&(dict.type=mapping[v.type]),"InventoryService"!==serviceName&&"DirectoryService"!==serviceName||"description"==v.name&&(dict.width=250),"CompanyService"===serviceName&&"aboutus_text"==v.name&&(dict.width=250),"active"==v.name&&(dict.width=50),readOnly&&(dict.readOnly=!0),editData&&("sub_category"!=v.name&&"sub_sub_category"!=v.name&&"sub_sub_sub_category"!=v.name&&"sub_category"!=v.name&&"category"!=v.name&&"state"!=v.name&&"country"!=v.name&&"city"!=v.name||(dict.readOnly=!0,dict.width=50),"active"==v.name&&(dict.width=50),"description"==v.name&&(dict.width=250)),disableColumns&&("category"!=v.name&&"city"!=v.name||(dict.readOnly=!0,dict.width=50),"description"==v.name&&(dict.width=250)),v.forced_write&&(dict.readOnly=!1),"url"!=v.name&&"id"!=v.name&&"created_date"!=v.name&&"updated_date"!=v.name&&"created"!=v.name&&"updated"!=v.name||(dict.readOnly=!0,dict.width=50),v.choices&&v.choices.length>0&!readOnly&!v.auto_created&&(dict.type="autocomplete",dict.source=v.choices.map(function(v){return v[0]}),dict.width=150,dict.strict=!0),v.auto_created&&(dict.readOnly=!0),"FileField"==v.type&&(dict.renderer="my.img.renderer",dict.editor="my.img.editor"),"ManyToManyField"==v.type&!v.auto_created&&(dict.renderer="my.manyToMany.renderer",dict.editor="my.manyToMany.editor",dict.source=v.choices.map(function(v){return v[0]})),dict});if("UserService"===serviceName){for(var col1=[],col2=[],i=0;i<colInfoArray.length;i+=1){var data=colInfoArray[i].data;"is_superuser"===data||"is_staff"===data||"is_active"===data||"is_email_verified"===data||"image"===data||"is_seller"===data||"is_buyer"===data||"created"===data||"is_admin_supplier"===data||"is_verified"===data?col1.push(colInfoArray[i]):col2.push(colInfoArray[i])}var result=col2.concat(col1);return col2=result}if("CustomerService"===serviceName||"BuyerSupplierService"==serviceName){for(var col1=[],col2=[],i=0;i<colInfoArray.length;i+=1){var data=colInfoArray[i].data;"created_date"===data?col1.push(colInfoArray[i]):col2.push(colInfoArray[i])}var result=col2.concat(col1);return col2=result}return colInfoArray},service.postOrPut=function(changes){var post_or_put={};post_or_put.post=[],post_or_put.put=[];for(var i=0;i<changes.length;i+=1){var single_change=changes[i],single_change_dict={};single_change_dict.row=single_change[0],single_change_dict[single_change[1]]=single_change[3],single_change[4]?(single_change_dict.id=single_change[4],post_or_put.put.push(single_change_dict)):post_or_put.post.push(single_change_dict)}return post_or_put},service.postRecords=function(posts){for(var post_records=[],i=0;i<posts.length;i+=1){for(var pre_existing_id=!1,j=0;j<post_records.length;j+=1)post_records[j].row==posts[i].row&&(pre_existing_id=!0,delete posts[i].row,post_records[j]=angular.merge({},post_records[j],posts[i]));pre_existing_id||post_records.push(posts[i])}return post_records},service.putRecords=function(puts){for(var put_records=[],i=0;i<puts.length;i+=1){for(var pre_existing_id=!1,j=0;j<put_records.length;j+=1)put_records[j].id==puts[i].id&&(pre_existing_id=!0,delete puts[i].id,delete puts[i].row,angular.extend(put_records[j],puts[i]));pre_existing_id||put_records.push(puts[i])}return put_records},service.deleteRecords=function(deletes){return deletes},service}])}();